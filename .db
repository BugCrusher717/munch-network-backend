// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

enum WalletTypes {
  unisat
  hiro
  xverse
}

enum OfferStatus {
  created // created the psbt
  signed //buy signed the psbt
  accepted // owner signed the psbt 
  pushed // combine and pushed
  failed // failed when push transaction
}

Table user {
  id integer [pk]
  uuid varchar
  email email
  name varchar
  bio timestamp
  website varchar
  twitter varchar
  facebook varchar
  address varchar
  pubkey varchar
  walletType WalletTypes
  isRegistered boolean
}

Table buy_now_activity {
  id integer [pk]
  uuid varchar
  user_id integer [ref: > user.id]
  price double
  inscription_id integer [ref:> inscription.id]
}

Table buy_now_offer {
  id integer [pk]
  uuid varchar
  buy_now_activity_id integer [ref: > buy_now_activity.id]
  user_id int [ref: > user.id]
  price double
  status OfferStatus
  psbt varchar
  user_signed_psbt varchar
  buyser_signed_psbt varchar
  is_read boolean
}

Table collection {
  id integer [pk]
  uuid varchar
  name varchar
  image_url varchar
  description varchar
}

Table inscription {
  id integer [pk]
  uuid varchar
  inscription_id varchar
  collection_id integer [ref: > collection.id]
}